<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ù…ØµØ­Ù Ø§Ù„ØªÙ„Ø§ÙˆØ© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© â€” v2.0</title>
  <style>
    :root{
      --bg:#f7fff8;
      --card:#ffffff;
      --muted:#6b6b6b;
      --accent:#06723f; /* Ø£Ø®Ø¶Ø± Ù‡Ø§Ø¯Ø¦ */
      --accent-dark:#054e2c;
      --glass: rgba(255,255,255,0.6);
      --radius:14px;
      --shadow: 0 8px 30px rgba(6,114,3,0.06);
      --text:#0b2b22;
      --success:#0b8e45;
      --danger:#c43737;
      font-family: "Noto Kufi Arabic","Segoe UI", Tahoma, Arial, system-ui;
    }
    /* Dark theme variables (will be used when body.dark) */
    body.dark { --bg: #0f1720; --card:#0b1220; --muted:#bfc8ce; --text:#eef6ef; --accent:#2fa06a; --accent-dark:#19905a; --glass: rgba(255,255,255,0.03); }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;padding:0}
    body{
      background:linear-gradient(180deg,var(--bg) 0%,#ffffff 60%);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:20px;
      display:flex;
      justify-content:center;
      font-size:15px;
    }
    .wrap{
      width:100%;
      max-width:1180px;
      background:var(--card);
      border-radius:14px;
      box-shadow:var(--shadow);
      padding:18px;
      border:1px solid rgba(6,114,3,0.06);
      overflow:hidden;
    }

    header{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .head-left{display:flex;gap:12px;align-items:center}
    .basmala{
      font-size:20px;
      font-weight:700;
      color:var(--accent-dark);
      letter-spacing:1px;
      text-align:center;
      margin-bottom:6px;
      font-family: "Amiri", "Noto Kufi Arabic", serif;
    }
    .title{
      display:flex;flex-direction:column;
    }
    .title h1{margin:0;font-size:20px}
    .title p{margin:4px 0 0;color:var(--muted);font-size:13px}

    .controls-top{display:flex;gap:8px;align-items:center}
    .btn{
      padding:8px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);
      background:transparent;cursor:pointer;color:var(--text);
    }
    .btn.primary{background:linear-gradient(180deg,var(--accent),var(--accent-dark));color:white;border:none;box-shadow:0 8px 20px rgba(6,114,3,0.14)}
    .toggle{display:inline-flex;gap:8px;align-items:center}

    .layout{display:grid;grid-template-columns:320px 1fr;gap:16px;margin-top:12px}
    aside.sidebar{
      border-radius:12px;padding:12px;border:1px solid rgba(6,114,3,0.03);background:linear-gradient(180deg,#fff,#fbfffb);
      height:calc(100vh - 190px);overflow:auto;
    }
    .search{display:flex;gap:8px;margin-bottom:8px}
    .search input{flex:1;padding:8px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:var(--text)}
    .section-title{font-weight:700;color:var(--accent);margin:10px 0 6px}

    .surah-list{display:flex;flex-direction:column;gap:6px}
    .surah-item{
      display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;
      cursor:pointer;transition:all .12s ease;border:1px solid transparent;
      background:transparent;color:var(--text);
    }
    .surah-item:hover{transform:translateX(6px);background:rgba(6,114,3,0.03)}
    .surah-item.active{background:linear-gradient(90deg,#e9fff0,#ffffff);border:1px solid rgba(6,114,3,0.06)}

    /* make english name lighter when Arabic default, but ensure contrast in dark mode */
    .surah-name-en{color:var(--muted);font-size:13px;}
    body.dark .surah-name-en{color:#cbd5cf}

    main.panel{
      border-radius:12px;padding:16px;border:1px solid rgba(6,114,3,0.03);
      background:linear-gradient(180deg,#fff,#fbfffb);box-shadow:0 6px 18px rgba(10,10,10,0.03);
      min-height:520px;
    }

    .top-info{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .player-row{display:flex;gap:12px;align-items:center;margin-top:12px;flex-wrap:wrap}
    .play-btn{padding:12px 18px;border-radius:12px;border:none;background:linear-gradient(180deg,var(--accent),var(--accent-dark));color:white;font-weight:700;cursor:pointer;box-shadow:0 8px 20px rgba(6,114,3,0.16)}
    .play-btn.paused{background:transparent;color:var(--accent);border:1px solid rgba(6,114,3,0.12);box-shadow:none}
    .meta{display:flex;flex-direction:column}
    .meta .title{font-weight:800;font-size:18px}
    .meta .info{color:var(--muted);font-size:13px}

    .controls-row{display:flex;gap:12px;align-items:center;margin-top:12px;flex-wrap:wrap}
    select,input[type="range"]{padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:transparent;color:var(--text)}
    .small{padding:8px 10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:transparent;cursor:pointer}

    .progress{margin-top:12px}
    .progress-bar{height:10px;background:#eef7f3;border-radius:99px;overflow:hidden;cursor:pointer}
    .progress-bar > i{display:block;height:100%;width:0;background:linear-gradient(90deg,#0bb07a,#02683a)}

    .time-row{display:flex;justify-content:space-between;color:var(--muted);font-size:13px;margin-top:6px}

    .options{display:flex;gap:8px;align-items:center;margin-top:12px;flex-wrap:wrap}

    .hadith-card{
      margin-top:16px;padding:14px;border-radius:12px;border:1px solid rgba(6,114,3,0.04);
      background:linear-gradient(180deg,#fbfff9,#ffffff);box-shadow:0 6px 16px rgba(6,114,3,0.03);
    }
    .hadith-text{font-size:16px;line-height:1.6;color:var(--text)}
    .hadith-translation{margin-top:10px;color:var(--muted);font-size:14px}

    footer{margin-top:14px;color:var(--muted);font-size:13px;display:flex;justify-content:space-between;flex-wrap:wrap;padding-top:10px;border-top:1px dashed rgba(6,114,3,0.04)}
    .note{color:var(--muted);font-size:13px;margin-top:8px}

    /* small screens */
    @media(max-width:980px){
      .layout{grid-template-columns:1fr;gap:12px}
      aside.sidebar{height:auto;max-height:320px}
    }
    /* ğŸ”¹ Ø¬Ø¹Ù„ Ø§Ù„ØµÙØ­Ø© Ù…ØªØ¬Ø§ÙˆØ¨Ø© Ù…Ø¹ ÙƒÙ„ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© */
html, body {
  width: 100%;
  height: 100%;
  overflow-x: hidden;
}

.container, main, section {
  max-width: 100%;
  box-sizing: border-box;
}

/* Ø§Ù„Ù†ØµÙˆØµ ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± */
h1, h2, h3, p, button, select, input {
  max-width: 100%;
  word-wrap: break-word;
}

/* Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª */
img, video, iframe {
  max-width: 100%;
  height: auto;
}

/* Ø¹Ù†Ø¯ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© (Ø§Ù„Ù‡Ø§ØªÙ) */
@media (max-width: 768px) {
  body {
    font-size: 15px;
    padding: 5px;
  }

  header, footer {
    text-align: center;
  }

  main {
    padding: 10px;
  }

  button, select, input {
    font-size: 1em;
    padding: 8px 12px;
  }

  .controls, .buttons, nav, .sidebar {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }

  /* ØªÙ‚Ù„ÙŠÙ„ Ø­Ø¬Ù… Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
  audio, video {
    width: 100%;
  }
}

/* Ø¹Ù†Ø¯ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù„ÙˆØ­ÙŠØ© */
@media (min-width: 769px) and (max-width: 1024px) {
  body {
    font-size: 16px;
  }
  main {
    padding: 15px;
  }
}

/* Ø¹Ù†Ø¯ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
@media (min-width: 1025px) {
  body {
    font-size: 18px;
  }
}
  </style>
</head>
<body>
  <div class="wrap" role="application" aria-label="Ù…ØµØ­Ù Ø§Ù„ØªÙ„Ø§ÙˆØ© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©">
    <header>
      <div class="head-left">
        <div>
          <div class="basmala" id="basmala">Ø¨ÙØ³Ù’Ù…Ù Ø§Ù„Ù„Ù‘ÙÙ‡Ù Ø§Ù„Ø±Ù‘ÙØ­Ù’Ù…ÙÙ†Ù Ø§Ù„Ø±Ù‘ÙØ­ÙÙŠÙ…Ù</div>
          <div class="title">
            <h1 id="siteTitle">Ù…ØµØ­Ù Ø§Ù„ØªÙ„Ø§ÙˆØ© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</h1>
            <p id="siteSubtitle">Ø§Ø³ØªÙ…Ø¹ Ø¨Ø®Ø´ÙˆØ¹ â€” Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ø±Ø¦ ÙˆØ§Ù„Ø³ÙˆØ±Ø©</p>
          </div>
        </div>
      </div>

      <div class="controls-top">
        <div style="display:flex;gap:8px;align-items:center">
          <button id="themeToggle" class="btn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¸Ù„Ù…">ÙˆØ¶Ø¹ Ù…Ø¸Ù„Ù… ğŸŒ™</button>
          <button id="langToggle" class="btn" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù„ØºØ©">EN â†” AR</button>
          <button id="refreshTip" class="btn" title="ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙØ§Ø¦Ø¯Ø©">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙØ§Ø¦Ø¯Ø©</button>
        </div>
      </div>
    </header>

    <!-- ÙØ§Ø¦Ø¯Ø©/Ø¯Ø¹Ø§Ø¡/Ø¢ÙŠØ© Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© -->
    <div id="tipCard" style="margin-top:12px;padding:12px;border-radius:10px;background:linear-gradient(90deg,#f2fff6,#ffffff);border:1px solid rgba(6,114,3,0.04)">
      <div id="tipText" style="font-size:15px;color:var(--text)"></div>
    </div>

    <div class="layout">
      <aside class="sidebar" aria-label="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙˆØ±">
        <div class="search">
          <input id="searchInput" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø³ÙˆØ±Ø© Ø£Ùˆ Ø±Ù‚Ù…Ù‡Ø§..." aria-label="Ø¨Ø­Ø« Ø§Ù„Ø³ÙˆØ±">
          <button id="clearSearch" class="btn">Ù…Ø³Ø­</button>
        </div>

        <div class="section-title" id="surahTitleHeader">Ø§Ù„Ø³ÙˆØ±</div>
        <div id="surahList" class="surah-list" role="list" aria-label="Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙˆØ±"></div>

        <div class="section-title" style="margin-top:12px" id="favHeader">Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª</div>
        <div id="favorites" style="display:flex;flex-direction:column;gap:8px"></div>
      </aside>

      <main class="panel" role="main" aria-label="Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ">
        <div class="top-info">
          <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
            <label for="reciterSelect">Ø§Ù„Ù‚Ø§Ø±Ø¦</label>
            <select id="reciterSelect"></select>

            <label for="surahSelect">Ø§Ù„Ø³ÙˆØ±Ø©</label>
            <select id="surahSelect"></select>

            <button id="downloadBtn" class="small">ØªÙ†Ø²ÙŠÙ„</button>
          </div>

          <div style="display:flex;gap:8px;align-items:center">
            <div style="text-align:center">
              <div style="font-weight:700" id="langLabel">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</div>
              <div style="color:var(--muted);font-size:13px" id="descLabel">ÙˆØ§Ø¬Ù‡Ø© Ø¹Ø±Ø¨ÙŠØ©</div>
            </div>
          </div>
        </div>

        <div class="player-row">
          <button id="playBtn" class="play-btn">ØªØ´ØºÙŠÙ„ â–¶</button>

          <div class="meta" style="min-width:320px">
            <div class="title" id="nowTitle">-</div>
            <div class="info" id="nowInfo">Ø§Ù„Ù‚Ø§Ø±Ø¦: -</div>
          </div>

          <div style="flex:1"></div>

          <div style="display:flex;gap:8px;align-items:center">
            <label style="color:var(--muted);font-size:13px">ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ</label>
            <input id="autoPlay" type="checkbox" />
          </div>
        </div>

        <div class="controls-row">
          <div style="display:flex;gap:8px;align-items:center">
            <label>Ø§Ù„ØµÙˆØª</label>
            <input id="volume" type="range" min="0" max="1" step="0.01" value="1" />
            <span id="volPct" style="min-width:44px;color:var(--muted)">100%</span>
          </div>

          <div style="display:flex;gap:8px;align-items:center">
            <label>Ø§Ù„Ø³Ø±Ø¹Ø©</label>
            <input id="rate" type="range" min="0.5" max="1.8" step="0.1" value="1" />
            <span id="ratePct" style="min-width:44px;color:var(--muted)">1.0Ã—</span>
          </div>

          <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
            <button id="prevBtn" class="small">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
            <button id="nextBtn" class="small">Ø§Ù„ØªØ§Ù„ÙŠ</button>
            <button id="loopBtn" class="small">ØªÙƒØ±Ø§Ø±</button>
            <button id="shuffleBtn" class="small">Ø®Ù„Ø·</button>
          </div>
        </div>

        <div class="progress" style="margin-top:12px">
          <div class="progress-bar" id="progressBar" role="progressbar" aria-valuemin="0" aria-valuemax="100">
            <i id="progressFill"></i>
          </div>
          <div class="time-row">
            <span id="curTime">00:00</span>
            <span id="durTime">00:00</span>
          </div>
        </div>

        <audio id="player" controls preload="none" style="width:100%;margin-top:12px;border-radius:10px"></audio>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø£Ø±Ø¨Ø¹ÙˆÙ† Ø§Ù„Ù†ÙˆÙˆÙŠØ© (Ø¹Ø±Ø¶ Ø­Ø¯ÙŠØ« ÙˆØ§Ø­Ø¯ Ù…Ø¹ ØªØ±Ø¬Ù…ØªÙ‡) -->
        <div class="hadith-card" id="hadithCard" aria-live="polite">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:700">Ø§Ù„Ø£Ø±Ø¨Ø¹ÙˆÙ† Ø§Ù„Ù†ÙˆÙˆÙŠØ© â€” Ø§Ù„Ø­Ø¯ÙŠØ« <span id="hadithNum">1</span> / 40</div>
            <div style="display:flex;gap:8px;align-items:center">
              <button id="hadithPrev" class="small">â—€ Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
              <button id="hadithNext" class="small">Ø§Ù„ØªØ§Ù„ÙŠ â–¶</button>
            </div>
          </div>

          <div id="hadithText" class="hadith-text" style="margin-top:10px">...</div>
          <div id="hadithTrans" class="hadith-translation">...</div>
        </div>

        <div class="note">Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¥Ù† Ù„Ù… ÙŠØ¹Ù…Ù„ Ø§Ù„ØµÙˆØª Ù„Ø¨Ø¹Ø¶ Ø§Ù„Ù‚Ø±Ù‘Ø§Ø¡ ÙØ°Ù„Ùƒ Ù‚Ø¯ ÙŠØ¹ÙˆØ¯ Ù„Ù…ØµØ¯Ø± Ø§Ù„Ù…Ù„Ù â€” ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª.</div>

      </main>
    </div>

    <footer>
      <div>Â© 2025 Ù…ØµØ­Ù Ø§Ù„ØªÙ„Ø§ÙˆØ© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© â€“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</div>
      <div id="footerRight">ØµÙ…Ù… Ù„Ø±Ø§Ø­Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</div>
    </footer>
  </div>

  <script>
    /**********************
      Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    **********************/
    // Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø³ÙˆØ± Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆØ§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (114)
    const surahData = [
      ["Ø§Ù„ÙØ§ØªØ­Ø©","Al-FÄtiá¸¥ah"],["Ø§Ù„Ø¨Ù‚Ø±Ø©","Al-Baqarah"],["Ø¢Ù„ Ø¹Ù…Ø±Ø§Ù†","Ä€l Ê¿ImrÄn"],["Ø§Ù„Ù†Ø³Ø§Ø¡","An-NisÄ'"],["Ø§Ù„Ù…Ø§Ø¦Ø¯Ø©","Al-MÄ'idah"],
      ["Ø§Ù„Ø£Ù†Ø¹Ø§Ù…","Al-AnÊ¿Äm"],["Ø§Ù„Ø£Ø¹Ø±Ø§Ù","Al-AÊ¿rÄf"],["Ø§Ù„Ø£Ù†ÙØ§Ù„","Al-AnfÄl"],["Ø§Ù„ØªÙˆØ¨Ø©","At-Tawbah"],["ÙŠÙˆÙ†Ø³","YÅ«nus"],
      ["Ù‡ÙˆØ¯","HÅ«d"],["ÙŠÙˆØ³Ù","YÅ«suf"],["Ø§Ù„Ø±Ø¹Ø¯","Ar-RaÊ¿d"],["Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ…","IbrÄhÄ«m"],["Ø§Ù„Ø­Ø¬Ø±","Al-á¸¤ijr"],
      ["Ø§Ù„Ù†Ø­Ù„","An-Naá¸¥l"],["Ø§Ù„Ø¥Ø³Ø±Ø§Ø¡","Al-IsrÄ'"],["Ø§Ù„ÙƒÙ‡Ù","Al-Kahf"],["Ù…Ø±ÙŠÙ…","Maryam"],["Ø·Ù‡","á¹¬ÄhÄ"],
      ["Ø§Ù„Ø£Ù†Ø¨ÙŠØ§Ø¡","Al-AnbiyÄ'"],["Ø§Ù„Ø­Ø¬","Al-á¸¤ajj"],["Ø§Ù„Ù…Ø¤Ù…Ù†ÙˆÙ†","Al-Mu'minÅ«n"],["Ø§Ù„Ù†ÙˆØ±","An-NÅ«r"],["Ø§Ù„ÙØ±Ù‚Ø§Ù†","Al-FurqÄn"],
      ["Ø§Ù„Ø´Ø¹Ø±Ø§Ø¡","Ash-ShuÊ¿arÄ'"],["Ø§Ù„Ù†Ù…Ù„","An-Naml"],["Ø§Ù„Ù‚ØµØµ","Al-Qaá¹£aá¹£"],["Ø§Ù„Ø¹Ù†ÙƒØ¨ÙˆØª","Al-Ê¿AnkabÅ«t"],["Ø§Ù„Ø±ÙˆÙ…","Ar-RÅ«m"],
      ["Ù„Ù‚Ù…Ø§Ù†","LuqmÄn"],["Ø§Ù„Ø³Ø¬Ø¯Ø©","As-Sajdah"],["Ø§Ù„Ø£Ø­Ø²Ø§Ø¨","Al-Aá¸¥zÄb"],["Ø³Ø¨Ø£","Saba'"],["ÙØ§Ø·Ø±","FÄá¹­ir"],
      ["ÙŠØ³","YÄ SÄ«n"],["Ø§Ù„ØµØ§ÙØ§Øª","As-á¹¢ÄffÄt"],["Øµ","á¹¢Äd"],["Ø§Ù„Ø²Ù…Ø±","Az-Zumar"],["ØºØ§ÙØ±","GhÄfir"],
      ["ÙØµÙ„Øª","Fussilat"],["Ø§Ù„Ø´ÙˆØ±Ù‰","Ash-ShÅ«rÄ"],["Ø§Ù„Ø²Ø®Ø±Ù","Az-Zukhruf"],["Ø§Ù„Ø¯Ø®Ø§Ù†","Ad-DukhÄn"],["Ø§Ù„Ø¬Ø§Ø«ÙŠØ©","Al-JÄthiyah"],
      ["Ø§Ù„Ø£Ø­Ù‚Ø§Ù","Al-Aá¸¥qÄf"],["Ù…Ø­Ù…Ø¯","Muá¸¥ammad"],["Ø§Ù„ÙØªØ­","Al-Fatá¸¥"],["Ø§Ù„Ø­Ø¬Ø±Ø§Øª","Al-á¸¤ujurÄt"],["Ù‚","QÄf"],
      ["Ø§Ù„Ø°Ø§Ø±ÙŠØ§Øª","Adh-DhÄriyÄt"],["Ø§Ù„Ø·ÙˆØ±","At-á¹¬Å«r"],["Ø§Ù„Ù†Ø¬Ù…","An-Najm"],["Ø§Ù„Ù‚Ù…Ø±","Al-Qamar"],["Ø§Ù„Ø±Ø­Ù…Ù†","Ar-Raá¸¥mÄn"],
      ["Ø§Ù„ÙˆØ§Ù‚Ø¹Ø©","Al-WÄqi'ah"],["Ø§Ù„Ø­Ø¯ÙŠØ¯","Al-á¸¤adÄ«d"],["Ø§Ù„Ù…Ø¬Ø§Ø¯Ù„Ø©","Al-MujÄdilah"],["Ø§Ù„Ø­Ø´Ø±","Al-á¸¤ashr"],["Ø§Ù„Ù…Ù…ØªØ­Ù†Ø©","Al-Mumtahanah"],
      ["Ø§Ù„ØµÙ","As-á¹¢aff"],["Ø§Ù„Ø¬Ù…Ø¹Ø©","Al-Jumu'ah"],["Ø§Ù„Ù…Ù†Ø§ÙÙ‚ÙˆÙ†","Al-MunÄfiqÅ«n"],["Ø§Ù„ØªØºØ§Ø¨Ù†","At-TaghÄbun"],["Ø§Ù„Ø·Ù„Ø§Ù‚","Aá¹­-á¹¬alÄq"],
      ["Ø§Ù„ØªØ­Ø±ÙŠÙ…","At-Taá¸¥rÄ«m"],["Ø§Ù„Ù…Ù„Ùƒ","Al-Mulk"],["Ø§Ù„Ù‚Ù„Ù…","Al-Qalam"],["Ø§Ù„Ø­Ø§Ù‚Ø©","Al-á¸¤Äqqah"],["Ø§Ù„Ù…Ø¹Ø§Ø±Ø¬","Al-Ma'Ärij"],
      ["Ù†ÙˆØ­","NÅ«á¸¥"],["Ø§Ù„Ø¬Ù†","Al-Jinn"],["Ø§Ù„Ù…Ø²Ù…Ù„","Al-Muzzammil"],["Ø§Ù„Ù…Ø¯Ø«Ø±","Al-Muddaththir"],["Ø§Ù„Ù‚ÙŠØ§Ù…Ø©","Al-QiyÄmah"],["Ø§Ù„Ø¥Ù†Ø³Ø§Ù†","Al-InsÄn"],
      ["Ø§Ù„Ù…Ø±Ø³Ù„Ø§Øª","Al-MursalÄt"],["Ø§Ù„Ù†Ø¨Ø£","An-Naba'"],["Ø§Ù„Ù†Ø§Ø²Ø¹Ø§Øª","An-NÄzi'Ät"],["Ø¹Ø¨Ø³","Ê¿Abasa"],["Ø§Ù„ØªÙƒÙˆÙŠØ±","At-TakwÄ«r"],
      ["Ø§Ù„Ø§Ù†ÙØ·Ø§Ø±","Al-Infiá¹­Är"],["Ø§Ù„Ù…Ø·ÙÙÙŠÙ†","Al-Muá¹­affifÄ«n"],["Ø§Ù„Ø§Ù†Ø´Ù‚Ø§Ù‚","Al-InshiqÄq"],["Ø§Ù„Ø¨Ø±ÙˆØ¬","Al-BurÅ«j"],["Ø§Ù„Ø·Ø§Ø±Ù‚","Aá¹­-á¹¬Äriq"],
      ["Ø§Ù„Ø£Ø¹Ù„Ù‰","Al-AÊ¿lÄ"],["Ø§Ù„ØºØ§Ø´ÙŠØ©","Al-GhÄshiyah"],["Ø§Ù„ÙØ¬Ø±","Al-Fajr"],["Ø§Ù„Ø¨Ù„Ø¯","Al-Balad"],["Ø§Ù„Ø´Ù…Ø³","Ash-Shams"],
      ["Ø§Ù„Ù„ÙŠÙ„","Al-Layl"],["Ø§Ù„Ø¶Ø­Ù‰","Ad-Duá¸¥Ä"],["Ø§Ù„Ø´Ø±Ø­","Ash-Shará¸¥"],["Ø§Ù„ØªÙŠÙ†","At-TÄ«n"],["Ø§Ù„Ø¹Ù„Ù‚","Al-Ê¿Alaq"],
      ["Ø§Ù„Ù‚Ø¯Ø±","Al-Qadr"],["Ø§Ù„Ø¨ÙŠÙ†Ø©","Al-Bayyinah"],["Ø§Ù„Ø²Ù„Ø²Ù„Ø©","Az-Zalzalah"],["Ø§Ù„Ø¹Ø§Ø¯ÙŠØ§Øª","Al-Ê¿Ä€diyÄt"],["Ø§Ù„Ù‚Ø§Ø±Ø¹Ø©","Al-QÄri'ah"],
      ["Ø§Ù„ØªÙƒØ§Ø«Ø±","At-TakÄthur"],["Ø§Ù„Ø¹ØµØ±","Al-Ê¿Aá¹£r"],["Ø§Ù„Ù‡Ù…Ø²Ø©","Al-Humazah"],["Ø§Ù„ÙÙŠÙ„","Al-FÄ«l"],["Ù‚Ø±ÙŠØ´","Quraysh"],["Ø§Ù„Ù…Ø§Ø¹ÙˆÙ†","Al-MÄÊ¿Å«n"],
      ["Ø§Ù„ÙƒÙˆØ«Ø±","Al-Kawthar"],["Ø§Ù„ÙƒØ§ÙØ±ÙˆÙ†","Al-KÄfirÅ«n"],["Ø§Ù„Ù†ØµØ±","An-Naá¹£r"],["Ø§Ù„Ù…Ø³Ø¯","Al-Masad"],["Ø§Ù„Ø¥Ø®Ù„Ø§Øµ","Al-IkhlÄá¹£"],["Ø§Ù„ÙÙ„Ù‚","Al-Falaq"],["Ø§Ù„Ù†Ø§Ø³","An-NÄs"]
    ];

    // Ù‚ÙˆØ§Ù„Ø¨ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚Ø±Ù‘Ø§Ø¡ (ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ù‡Ù†Ø§)
    const reciters = {
      "Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹ÙØ§Ø³ÙŠ": "https://download.quranicaudio.com/quran/mishaari_raashid_al_3afaasee/{num}.mp3",
      "Ø¹Ø¨Ø¯ Ø§Ù„Ø¨Ø§Ø³Ø· Ø¹Ø¨Ø¯ Ø§Ù„ØµÙ…Ø¯": "https://download.quranicaudio.com/quran/abdulbaset_mujawwad/{num}.mp3",
      "Ø§Ù„Ù…Ù†Ø´Ø§ÙˆÙŠ": "https://download.quranicaudio.com/quran/muhammad_siddeeq_al-minshaawee/{num}.mp3",
      " Ù…Ø§Ù‡Ø± Ø§Ù„Ù…Ø¹Ù‚Ù„ÙŠ": "https://download.quranicaudio.com/quran/maher_256/{num}.mp3",
      "ÙŠØ§Ø³Ø± Ø§Ù„Ø¯Ø³Ø±ÙŠ": "https://download.quranicaudio.com/quran/yasser_ad-dussary/{num}.mp3",
      "Ø³Ø¹ÙˆØ¯ Ø§Ù„Ø´Ø±ÙŠÙ…": "https://download.quranicaudio.com/quran/sa3ood_al-shuraym/{num}.mp3",
      "ÙŠÙˆÙ†Ø³ Ø£Ø³ÙˆÙŠÙ„Øµ": "https://server16.mp3quran.net/download/souilass/Rewayat-Warsh-A-n-Nafi/{num}.mp3",
      "Ø¨Ø¯Ø± Ø§Ù„ØªØ±ÙƒÙŠ": "https://server10.mp3quran.net/download/bader/Rewayat-Hafs-A-n-Assem/{num}.mp3"
       // Ù„Ø¥Ø¶Ø§ÙØ© Ù‚Ø§Ø±Ø¦ Ø¢Ø®Ø± Ø£Ø¯Ø®Ù„: "Ø§Ù„Ø§Ø³Ù…": "https://.../{num}.mp3"
    };

    // Ù‚Ø§Ø¦Ù…Ø© Ù„Ù„ÙÙˆØ§Ø¦Ø¯/Ø§Ù„Ø¢ÙŠØ§Øª/Ø§Ù„Ø£Ø¯Ø¹ÙŠØ©
    const tips = [
      {type:"Ø¢ÙŠØ©", ar:"ÙˆÙÙ‚ÙÙ„Ù’ Ø±ÙØ¨Ù‘Ù Ø²ÙØ¯Ù’Ù†ÙÙŠ Ø¹ÙÙ„Ù’Ù…Ù‹Ø§", en:"\"And say, 'My Lord, increase me in knowledge.'\" â€” Quran 20:114"},
      {type:"Ø¯Ø¹Ø§Ø¡", ar:"Ø±ÙØ¨Ù‘ÙÙ†ÙØ§ Ø¢ØªÙÙ†ÙØ§ Ù…ÙÙ† Ù„ÙÙ‘Ø¯ÙÙ†ÙƒÙ Ø±ÙØ­Ù’Ù…ÙØ©Ù‹ ÙˆÙÙ‡ÙÙŠÙ‘ÙØ¦Ù’ Ù„ÙÙ†ÙØ§ Ù…ÙÙ†Ù’ Ø£ÙÙ…Ù’Ø±ÙÙ†ÙØ§ Ø±ÙØ´ÙØ¯Ù‹Ø§", en:"\"Our Lord, grant us from Yourself mercy and prepare for us from our affair right guidance.\""},
      {type:"ÙØ§Ø¦Ø¯Ø©", ar:"Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø±Ø¢Ù† Ø¨Ø®Ø´ÙˆØ¹ ÙŠØ¹ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„ØªØ±ÙƒÙŠØ² ÙˆØ§Ù„ØªØ£Ù…Ù„.", en:"Listening to the Qur'an with presence helps concentration and reflection."},
      {type:"Ø¢ÙŠØ©", ar:"Ø¥ÙÙ†Ù‘ÙÙ…ÙØ§ Ø§Ù„Ù’Ù…ÙØ¤Ù’Ù…ÙÙ†ÙÙˆÙ†Ù Ø¥ÙØ®Ù’ÙˆÙØ©ÙŒ", en:"\"The believers are but brothers.\" â€” Quran 49:10"},
      {type:"Ø¯Ø¹Ø§Ø¡", ar:"Ø§Ù„Ù„Ù‡Ù… Ø§ÙØªØ­ Ù„Ù†Ø§ Ø£Ø¨ÙˆØ§Ø¨ Ø±Ø­Ù…ØªÙƒ", en:"\"O Allah, open for us the doors of Your mercy.\""}
    ];

    // Ø§Ù„Ø£Ø±Ø¨Ø¹ÙˆÙ† Ø§Ù„Ù†ÙˆÙˆÙŠØ© (Ù†Øµ Ø¹Ø±Ø¨ÙŠ + ØªØ±Ø¬Ù…Ø© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©) - Ø³Ø£Ø¶Ø¹ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ø¨Ø¹ÙŠÙ†.
    // Ù„Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø·ÙˆÙ„ Ø£Ø¯Ø±Ø¬Øª ØªØ±Ø¬Ù…Ø§Øª Ù…Ø¹Ù‚ÙˆÙ„Ø© Ù…Ø®ØªØµØ±Ø©Ø› ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù†ØµÙˆØµ Ù„Ø§Ø­Ù‚Ù‹Ø§.
    const ahadith = [
     
      // Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ù‚Ø±ÙŠØ¨ Ù…Ù† 40Ø› ÙŠÙ…ÙƒÙ†Ùƒ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù†ØµÙˆØµ Ø¨Ø§Ù„Ù†ØµÙˆØµ Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© Ù…Ù† Ù…ØµØ§Ø¯Ø± Ù…ÙˆØ«ÙˆÙ‚Ø©.
    ];

    /**********************
      Ø¹Ù†Ø§ØµØ± DOM
    **********************/
    const surahListEl = document.getElementById('surahList');
    const reciterSelect = document.getElementById('reciterSelect');
    const surahSelect = document.getElementById('surahSelect');
    const playBtn = document.getElementById('playBtn');
    const player = document.getElementById('player');
    const nowTitle = document.getElementById('nowTitle');
    const nowInfo = document.getElementById('nowInfo');
    const volume = document.getElementById('volume');
    const volPct = document.getElementById('volPct');
    const rate = document.getElementById('rate');
    const ratePct = document.getElementById('ratePct');
    const progressFill = document.getElementById('progressFill');
    const progressBar = document.getElementById('progressBar');
    const curTime = document.getElementById('curTime');
    const durTime = document.getElementById('durTime');
    const autoPlay = document.getElementById('autoPlay');
    const themeToggle = document.getElementById('themeToggle');
    const langToggle = document.getElementById('langToggle');
    const refreshTip = document.getElementById('refreshTip');
    const tipText = document.getElementById('tipText');
    const searchInput = document.getElementById('searchInput');
    const clearSearch = document.getElementById('clearSearch');
    const downloadBtn = document.getElementById('downloadBtn');
    const hadithNumEl = document.getElementById('hadithNum');
    const hadithTextEl = document.getElementById('hadithText');
    const hadithTransEl = document.getElementById('hadithTrans');
    const hadithPrev = document.getElementById('hadithPrev');
    const hadithNext = document.getElementById('hadithNext');
    const reciterKeyList = Object.keys(reciters);

    /**********************
      Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    **********************/
    let currentReciter = reciterKeyList[0];
    let currentIndex = 0; // 0-based index for surah
    let isDark = false;
    let locale = 'ar'; // 'ar' or 'en'
    let hadithIndex = 0;
    let isLoop = false, isShuffle = false;
    let favorites = JSON.parse(localStorage.getItem('mt_favs') || '[]');

    /**********************
      Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
    **********************/
    function pad3(n){ return String(n).padStart(3,'0'); }
    function formatTime(t){ if(!isFinite(t)) return '00:00'; const m=Math.floor(t/60).toString().padStart(2,'0'); const s=Math.floor(t%60).toString().padStart(2,'0'); return m+':'+s; }
    function templateURL(reciter, num3){ const tpl = reciters[reciter]; return tpl ? tpl.replace('{num}', num3) : ''; }
    function chooseRandomTip(){ return tips[Math.floor(Math.random()*tips.length)]; }

    /**********************
      Ù…Ù„Ø¡ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… ÙˆØ§Ù„ÙˆØ§Ø¬Ù‡Ø©
    **********************/
    function populateReciters(){
      reciterSelect.innerHTML = '';
      reciterKeyList.forEach(name=>{
        const opt = document.createElement('option'); opt.value = name; opt.textContent = name;
        reciterSelect.appendChild(opt);
      });
    }

    function populateSurahs(){
      surahListEl.innerHTML = '';
      surahSelect.innerHTML = '';
      surahData.forEach((s, idx)=>{
        const num = idx+1; const num3 = pad3(num);
        const item = document.createElement('div');
        item.className = 'surah-item';
        item.dataset.num = num3;
        // show arabic + english based on locale (but always include both for readability)
        item.innerHTML = `<div>
          <div style="font-weight:700">${num}. ${s[0]}</div>
          <div class="surah-name-en">${s[1]}</div>
        </div>
        <div style="color:var(--muted);font-size:13px">â–¶</div>`;
        item.addEventListener('click', ()=> {
          selectSurahByIndex(idx);
          if(autoPlay.checked) playSelected(); // if autoplay enabled
        });
        item.addEventListener('dblclick', ()=> {
          selectSurahByIndex(idx);
          playSelected();
        });
        surahListEl.appendChild(item);

        const opt = document.createElement('option');
        opt.value = num3; opt.textContent = `${num} - ${s[ (locale==='ar')?0:1 ]}`;
        surahSelect.appendChild(opt);
      });
    }

    function highlightSurah(num3){
      document.querySelectorAll('.surah-item').forEach(it => it.classList.toggle('active', it.dataset.num === num3));
    }

    function updateNowTitle(){
      const s = surahData[currentIndex];
      nowTitle.textContent = locale==='ar' ? `${s[0]} â€” Ø³ÙˆØ±Ø© Ø±Ù‚Ù… ${currentIndex+1}` : `${s[1]} â€” Surah ${currentIndex+1}`;
      nowInfo.textContent = locale==='ar' ? `Ø§Ù„Ù‚Ø§Ø±Ø¦: ${currentReciter}` : `Reciter: ${currentReciter}`;
    }

    /**********************
      Ø§Ù„ØªØ´ØºÙŠÙ„ ÙˆØ§Ù„ØªØ­ÙƒÙ…
    **********************/
    function setPlayerSource(){
      const num3 = pad3(currentIndex+1);
      const url = templateURL(currentReciter, num3);
      if(!url){
        alert(locale==='ar' ? 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø§Ø¨Ø· ØµÙˆØª Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø§Ø±Ø¦ Ø­Ø§Ù„ÙŠÙ‹Ø§.' : 'No audio source for this reciter currently.');
        return false;
      }
      player.src = url;
      return true;
    }

    function playSelected(){
      if(!setPlayerSource()) return;
      player.play().catch(e=>console.warn(e));
      playBtn.textContent = locale==='ar' ? 'Ø¥ÙŠÙ‚Ø§Ù â– ' : 'Pause â– ';
      playBtn.classList.remove('paused');
    }

    function togglePlayPause(){
      if(!player.src) setPlayerSource();
      if(player.paused){
        player.play().catch(e=>console.warn(e));
        playBtn.textContent = locale==='ar' ? 'Ø¥ÙŠÙ‚Ø§Ù â– ' : 'Pause â– ';
        playBtn.classList.remove('paused');
      } else {
        player.pause();
        playBtn.textContent = locale==='ar' ? 'ØªØ´ØºÙŠÙ„ â–¶' : 'Play â–¶';
        playBtn.classList.add('paused');
      }
    }

    function selectSurahByIndex(idx){
      currentIndex = idx;
      const num3 = pad3(idx+1);
      surahSelect.value = num3;
      highlightSurah(num3);
      updateNowTitle();
      localStorage.setItem('mt_last', JSON.stringify({reciter:currentReciter,index:currentIndex,locale}));
    }

    /**********************
      Hadith controls
    **********************/
    function renderHadith(){
      const h = ahadith[hadithIndex] || {ar:'...',en:'...'};
      hadithNumEl.textContent = hadithIndex+1;
      hadithTextEl.textContent = locale==='ar' ? h.ar : h.en;
      hadithTransEl.style.display = (locale==='ar') ? 'none' : 'block';
      hadithTransEl.textContent = (locale==='ar') ? '' : h.en;
      // if locale is ar, show arabic and translation in english below if english selected; we already manage it by display
      if(locale==='ar'){
        hadithTextEl.textContent = h.ar;
        hadithTransEl.style.display='none';
      } else {
        hadithTextEl.textContent = h.en;
        hadithTransEl.style.display='none';
      }
    }

    /**********************
      Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ÙˆØ§Ù„Ø£Ø­Ø¯Ø§Ø«
    **********************/
    function init(){
      // fill lists
      populateReciters();
      populateSurahs();

      // restore state
      const saved = JSON.parse(localStorage.getItem('mt_last') || 'null');
      if(saved){
        if(saved.reciter && reciters[saved.reciter]) currentReciter = saved.reciter;
        if(typeof saved.index === 'number') currentIndex = saved.index;
        if(saved.locale) locale = saved.locale;
      }
      reciterSelect.value = currentReciter;
      // select initial surah
      selectSurahByIndex(currentIndex);

      // tip
      showTip();

      // hadith
      renderHadith();

      // display volume & rate initial
      volPct.textContent = Math.round(volume.value*100)+'%';
      ratePct.textContent = rate.value + 'Ã—';
      player.volume = Number(volume.value);
      player.playbackRate = Number(rate.value);
      // labels based on locale
      updateLocaleUI();

      // events
      reciterSelect.addEventListener('change', (e)=>{
        currentReciter = e.target.value;
        updateNowTitle();
        // if audio playing, update source and play
        if(!player.paused){
          const ok = setPlayerSource();
          if(ok) player.play().catch(()=>{});
        }
        localStorage.setItem('mt_last', JSON.stringify({reciter:currentReciter,index:currentIndex,locale}));
      });

      surahSelect.addEventListener('change', (e)=>{
        const idx = Number(e.target.value) - 1;
        selectSurahByIndex(idx);
        // set and play if autoplay or if audio playing
        if(autoPlay.checked || !player.paused) playSelected();
      });

      playBtn.addEventListener('click', togglePlayPause);

      volume.addEventListener('input', ()=>{
        player.volume = Number(volume.value);
        volPct.textContent = Math.round(player.volume*100) + '%';
      });

      rate.addEventListener('input', ()=>{
        player.playbackRate = Number(rate.value);
        ratePct.textContent = Number(rate.value).toFixed(1) + 'Ã—';
      });

      player.addEventListener('timeupdate', ()=>{
        const cur = player.currentTime || 0;
        const dur = player.duration || 0;
        const pct = dur ? Math.min(100,(cur/dur)*100) : 0;
        progressFill.style.width = pct + '%';
        curTime.textContent = formatTime(cur);
        durTime.textContent = dur ? formatTime(dur) : '00:00';
      });

      progressBar.addEventListener('click', (e)=>{
        const rect = progressBar.getBoundingClientRect();
        const x = Math.abs(e.clientX - rect.left);
        const pct = x / rect.width;
        if(player.duration) player.currentTime = player.duration * pct;
      });

      player.addEventListener('ended', ()=>{
        if(isLoop){ player.currentTime = 0; player.play(); return; }
        if(isShuffle){ currentIndex = Math.floor(Math.random()*surahData.length); selectSurahByIndex(currentIndex); playSelected(); return; }
        if(autoPlay.checked){
          let next = currentIndex + 1;
          if(next >= surahData.length) { next = 0; }
          selectSurahByIndex(next);
          playSelected();
        } else {
          playBtn.textContent = locale==='ar' ? 'ØªØ´ØºÙŠÙ„ â–¶' : 'Play â–¶';
          playBtn.classList.add('paused');
        }
      });

      prevBtn.addEventListener('click', ()=>{
        currentIndex = Math.max(0,currentIndex-1);
        selectSurahByIndex(currentIndex);
        playSelected();
      });
      nextBtn.addEventListener('click', ()=>{
        currentIndex = Math.min(surahData.length-1,currentIndex+1);
        selectSurahByIndex(currentIndex);
        playSelected();
      });

      loopBtn.addEventListener('click', ()=>{
        isLoop = !isLoop; loopBtn.style.background = isLoop ? 'rgba(6,114,3,0.08)' : 'transparent';
      });
      shuffleBtn.addEventListener('click', ()=>{
        isShuffle = !isShuffle; shuffleBtn.style.background = isShuffle ? 'rgba(6,114,3,0.08)' : 'transparent';
      });

      themeToggle.addEventListener('click', ()=>{
        isDark = !isDark;
        document.body.classList.toggle('dark', isDark);
        themeToggle.textContent = isDark ? (locale==='ar' ? 'ÙˆØ¶Ø¹ ÙØ§ØªØ­ â˜€ï¸' : 'Light â˜€ï¸') : (locale==='ar' ? 'ÙˆØ¶Ø¹ Ù…Ø¸Ù„Ù… ğŸŒ™' : 'Dark ğŸŒ™');
      });

      langToggle.addEventListener('click', ()=>{
        locale = (locale==='ar') ? 'en' : 'ar';
        // flip direction for en
        document.documentElement.lang = locale==='ar' ? 'ar' : 'en';
        document.documentElement.dir = locale==='ar' ? 'rtl' : 'ltr';
        // update UI texts
        updateLocaleUI();
        // rebuild surah lists (to show english names if needed)
        populateSurahs();
        selectSurahByIndex(currentIndex);
        renderHadith();
      });

      refreshTip.addEventListener('click', showTip);

      searchInput.addEventListener('input', ()=>{
        const q = searchInput.value.trim().toLowerCase();
        document.querySelectorAll('.surah-item').forEach(it=>{
          const txt = it.textContent.replace(/\s+/g,' ').toLowerCase();
          it.style.display = txt.includes(q) ? 'flex' : 'none';
        });
      });
      clearSearch.addEventListener('click', ()=>{ searchInput.value=''; searchInput.dispatchEvent(new Event('input')); });

      downloadBtn.addEventListener('click', ()=>{
        if(!player.src){ alert(locale==='ar' ? 'Ø§Ø®ØªØ± Ø³ÙˆØ±Ø© Ø£Ùˆ Ø´ØºÙ‘Ù„Ù‡Ø§ Ø£ÙˆÙ„Ø§Ù‹.' : 'Select or play a surah first.'); return; }
        window.open(player.src,'_blank');
      });

      hadithPrev.addEventListener('click', ()=>{
        hadithIndex = (hadithIndex - 1 + ahadith.length) % ahadith.length;
        renderHadith();
      });
      hadithNext.addEventListener('click', ()=>{
        hadithIndex = (hadithIndex + 1) % ahadith.length;
        renderHadith();
      });

      // keyboard space toggle
      document.addEventListener('keydown', (e)=>{
        if(e.code==='Space' && !['INPUT','TEXTAREA','SELECT','BUTTON'].includes(document.activeElement.tagName)){
          e.preventDefault(); togglePlayPause();
        }
      });

      // populate favorites UI
      renderFavorites();

      // save last state on unload
      window.addEventListener('beforeunload', ()=> {
        localStorage.setItem('mt_last', JSON.stringify({reciter:currentReciter,index:currentIndex,locale}));
        localStorage.setItem('mt_favs', JSON.stringify(favorites));
      });
    }

    function updateLocaleUI(){
      // update labels and button texts based on locale
      document.getElementById('siteTitle').textContent = locale==='ar' ? 'Ù…ØµØ­Ù Ø§Ù„ØªÙ„Ø§ÙˆØ© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©' : 'Electronic Recitation Mushaf';
      document.getElementById('siteSubtitle').textContent = locale==='ar' ? 'Ø§Ø³ØªÙ…Ø¹ Ø¨Ø®Ø´ÙˆØ¹ â€” Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø§Ø±Ø¦ ÙˆØ§Ù„Ø³ÙˆØ±Ø©' : 'Listen with presence â€” choose reciter & surah';
      document.getElementById('langLabel').textContent = locale==='ar' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'English';
      document.getElementById('descLabel').textContent = locale==='ar' ? 'ÙˆØ§Ø¬Ù‡Ø© Ø¹Ø±Ø¨ÙŠØ©' : 'English interface';
      document.getElementById('surahTitleHeader').textContent = locale==='ar' ? 'Ø§Ù„Ø³ÙˆØ±' : 'Surahs';
      document.getElementById('favHeader').textContent = locale==='ar' ? 'Ø§Ù„Ù…ÙØ¶Ù„Ø§Øª' : 'Favorites';
      playBtn.textContent = player && !player.paused ? (locale==='ar' ? 'Ø¥ÙŠÙ‚Ø§Ù â– ' : 'Pause â– ') : (locale==='ar' ? 'ØªØ´ØºÙŠÙ„ â–¶' : 'Play â–¶');
      // hadith label
      document.querySelector('.hadith-card div strong')?.parentNode;
      // tip header if needed
    }

    /**********************
      Tips / Basmala / hadith initial
    **********************/
    function showTip(){
      const t = chooseRandomTip();
      tipText.innerHTML = (locale==='ar') ? `<strong>${t.type}:</strong> ${t.ar}` : `<strong>${t.type}:</strong> ${t.en}`;
    }

    /**********************
      Favorites (simple)
    **********************/
    function renderFavorites(){
      const favEl = document.getElementById('favorites');
      favEl.innerHTML = '';
      if(favorites.length===0){
        favEl.innerHTML = `<div style="color:var(--muted)">${locale==='ar'?'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…ÙØ¶Ù„Ø§Øª Ø¨Ø¹Ø¯':'No favorites yet'}</div>`;
        return;
      }
      favorites.forEach((f, i)=>{
        const d = document.createElement('div');
        d.style.display='flex'; d.style.justifyContent='space-between'; d.style.alignItems='center';
        d.style.padding='6px'; d.style.borderRadius='8px'; d.style.border='1px dashed rgba(6,114,3,0.04)';
        d.innerHTML = `<div>${Number(f.num)}. ${f.name} <small style="color:var(--muted)">- ${f.reciterShort||f.reciter}</small></div>
          <div style="display:flex;gap:6px">
            <button class="small" data-i="${i}" data-action="play">â–¶</button>
            <button class="small" data-i="${i}" data-action="del">âœ–</button>
          </div>`;
        favEl.appendChild(d);
      });
      // attach actions
      favEl.querySelectorAll('button').forEach(b=>{
        b.addEventListener('click',(e)=>{
          const act = b.dataset.action; const idx = Number(b.dataset.i);
          if(act==='play'){ const it=favorites[idx]; currentIndex = Number(it.num)-1; currentReciter = it.reciter; reciterSelect.value=currentReciter; selectSurahByIndex(currentIndex); playSelected(); }
          if(act==='del'){ favorites.splice(idx,1); localStorage.setItem('mt_favs', JSON.stringify(favorites)); renderFavorites(); }
        });
      });
    }

    /**********************
      Ø§Ù„Ø¨Ø¯Ø¡
    **********************/
    init();

  </script>
</body>
</html>

